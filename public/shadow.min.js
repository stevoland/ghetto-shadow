/*! ghetto-shadow - v0.1.0 - 2012-10-23
* https://github.com/stevoland/ghetto-shadow
* Copyright (c) 2012 stevo (Stephen Collings); Licensed MIT */
var requirejs,require,define;(function(e){function l(e,t){var n,r,i,s,o,a,f,l,c,h,p=t&&t.split("/"),d=u.map,v=d&&d["*"]||{};if(e&&e.charAt(0)==="."&&t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))break;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=l;break}}}if(s)break;!a&&v&&v[r]&&(a=v[r],f=l)}!s&&a&&(s=a,o=f),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function c(t,r){return function(){return n.apply(e,f.call(arguments,0).concat([t,r]))}}function h(e){return function(t){return l(t,e)}}function p(e){return function(t){s[e]=t}}function d(n){if(o.hasOwnProperty(n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!s.hasOwnProperty(n)&&!a.hasOwnProperty(n))throw new Error("No "+n);return s[n]}function v(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function m(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=[].slice;r=function(e,t){var n,r=v(e),i=r[0];return e=r[1],i&&(i=l(i,t),n=d(i)),i?n&&n.normalize?e=n.normalize(e,h(t)):e=l(e,t):(e=l(e,t),r=v(e),i=r[0],e=r[1],i&&(n=d(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return c(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:m(e)}}},t=function(t,n,u,f){var l,h,v,m,g,y=[],b;f=f||t;if(typeof u=="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(g=0;g<n.length;g+=1){m=r(n[g],f),h=m.f;if(h==="require")y[g]=i.require(t);else if(h==="exports")y[g]=i.exports(t),b=!0;else if(h==="module")l=y[g]=i.module(t);else if(s.hasOwnProperty(h)||o.hasOwnProperty(h)||a.hasOwnProperty(h))y[g]=d(h);else{if(!m.p)throw new Error(t+" missing "+h);m.p.load(m.n,c(f,!0),p(h),{}),y[g]=s[h]}}v=u.apply(s[t],y);if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(v!==e||!b)s[t]=v}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){return typeof s=="string"?i[s]?i[s](o):d(r(s,o).f):(s.splice||(u=s,o.splice?(s=o,o=a,a=null):s=e),o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},15),n)},n.config=function(e){return u=e,n},define=function(e,t,n){t.splice||(n=t,t=[]),o[e]=[e,t,n]},define.amd={jQuery:!0}})(),define("almond",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("URL",[],t):e.URL=t()}(this,function(){function t(t){var n=e,r=n.parser[n.strictMode?"strict":"loose"].exec(t),i={},s=14;while(s--)i[n.key[s]]=r[s]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,function(e,t,r){t&&(i[n.q.name][t]=r)}),i}function n(e){var t="",n;e.protocol&&(t+=e.protocol+"://"),e.user&&(t+=e.user),e.password&&(t+=":"+e.password);if(e.user||e.password)t+="@";e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path);var r=e.queryKey,i=[];for(n in r){if(!r.hasOwnProperty(n))continue;var s=encodeURIComponent(r[n]);n=encodeURIComponent(n),s?i.push(n+"="+s):i.push(n)}return i.length>0&&(t+="?"+i.join("&")),e.anchor&&(t+="#"+e.anchor),t}var e={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};return{parse:t,make:n}}),function(e,t,n){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define("DOMTrigger",[],t):e.returnExports=t()}(this,function(){function n(e,t){for(var n in t)e[n]=t[n];return e}function r(r,i){var s=n(t,arguments[2]||{}),o,u=null,a=document;for(var f in e)if(e[f].test(i)){u=f;break}if(!u)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");if(a.createEvent)o=a.createEvent(u),u==="HTMLEvents"?o.initEvent(i,s.bubbles,s.cancelable):o.initMouseEvent(i,s.bubbles,s.cancelable,a.defaultView,s.button,s.pointerX,s.pointerY,s.pointerX,s.pointerY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r),o=n(o,s),r.dispatchEvent(o);else{s.clientX=s.pointerX,s.clientY=s.pointerY;var l=a.createEventObject();o=n(l,s),r.fireEvent("on"+i,o)}return r}var e={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},t={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0};return r}),function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define("CSSelector",[],t):e.returnExports=t()}(this,function(){function e(e){var t=[];while(e.parentNode){if(e.id){t.unshift("#"+e.id);break}if(e===e.ownerDocument.documentElement||e===e.ownerDocument.body)t.unshift(e.tagName);else{for(var n=1,r=e;r.previousElementSibling;r=r.previousElementSibling,n++);t.unshift(e.tagName+":nth-child("+n+")")}e=e.parentNode}return t.join(" > ")}return e}),!function(e,t){var n={isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},isPlainObject:function(e){return Object.prototype.toString.call(e)==="[object Object]"},toArray:function(e){return Array.prototype.slice.call(e)},getKeys:Object.keys||function(e){var t=[],n="";for(n in e)e.hasOwnProperty(n)&&t.push(n);return t},escape:function(e){return e.replace(/[,;"\\=\s%]/g,function(e){return encodeURIComponent(e)})},retrieve:function(e,n){return e===t?n:e}},r=function(){return r.get.apply(r,arguments)};r.defaults={},r.expiresMultiplier=86400,r.set=function(r,i,s){if(n.isPlainObject(r))for(var o in r)r.hasOwnProperty(o)&&this.set(o,r[o],i);else{s=n.isPlainObject(s)?s:{expires:s};var u=s.expires!==t?s.expires:this.defaults.expires||"",f=typeof u;f==="string"&&u!==""?u=new Date(u):f==="number"&&(u=new Date(+(new Date)+1e3*this.expiresMultiplier*u)),u!==""&&"toGMTString"in u&&(u=";expires="+u.toGMTString());var l=s.path||this.defaults.path;l=l?";path="+l:"";var h=s.domain||this.defaults.domain;h=h?";domain="+h:"";var p=s.secure||this.defaults.secure?";secure":"";e.cookie=n.escape(r)+"="+n.escape(i)+u+l+h+p}return this},r.remove=function(e){e=n.isArray(e)?e:n.toArray(arguments);for(var t=0,r=e.length;t<r;t++)this.set(e[t],"",-1);return this},r.empty=function(){return this.remove(n.getKeys(this.all()))},r.get=function(e,r){r=r||t;var i=this.all();if(n.isArray(e)){var s={};for(var o=0,u=e.length;o<u;o++){var a=e[o];s[a]=n.retrieve(i[a],r)}return s}return n.retrieve(i[e],r)},r.all=function(){if(e.cookie==="")return{};var t=e.cookie.split("; "),n={};for(var r=0,i=t.length;r<i;r++){var s=t[r].split("=");n[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return n},r.enabled=function(){if(navigator.cookieEnabled)return!0;var e=r.set("_","_").get("_")==="_";return r.remove("_"),e},typeof define=="function"&&define.amd?define("cookie",[],function(){return r}):typeof exports!="undefined"?exports.cookie=r:window.cookie=r}(document),define("client",["URL","DOMTrigger","CSSelector","cookie"],function(e,t,n,r){function c(e){var t=e||a.event,r={gsElements:[],gsDocuments:[],gsWindows:[],gsURI:d(t.target),gsSimulated:!0},i;if(t.gsSimulated)return!0;for(i in t)i!=="originalTarget"&&i!=="rangeParent"&&(t[i]instanceof HTMLElement?(r[i]=n(t[i]),r.gsElements.push(i)):t[i]===f?(r[i]="document",r.gsDocuments.push(i)):t[i]===a?(r[i]="window",r.gsWindows.push(i)):t[i]===null?r[i]=t[i]:typeof t[i]!="function"&&typeof t[i]!="object"&&(r[i]=t[i]));s.emit("event",r)}function h(e){var n,r=!0;if(e.gsElements){n=e.gsElements.length;while(n--)e[e.gsElements[n]]=f.querySelector(e[e.gsElements[n]]),e[e.gsElements[n]]===null&&(r=!1);delete e.gsElements}if(e.gsDocuments){n=e.gsDocuments.length;while(n--)e[e.gsDocuments[n]]=f;delete e.gsDocuments}if(e.gsWindows){n=e.gsWindows.length;while(n--)e[e.gsWindows[n]]=a;delete e.gsWindows}r?(e.gsSimulated=!0,e.type==="change"?p(e):t(e.originalTarget||e.target,e.type,e)):e.gsURI&&(a.location=e.gsURI)}function p(e){e.target.value=e.value}function d(e){var t,n;while(e){if(e.nodeName.toUpperCase()==="A"){t=e;break}e=e.parentNode}return t&&t.href&&(n=t.href),n}function v(e){r.set("gsclick",a.location.href,{expires:5}),c(e)}function m(e){e.value=e.target.value,c(e)}function g(e){var t=f.getElementsByTagName("script"),n=t[t.length-1],r=document.createElement("script"),i;r.type="text/javascript",r.async=!0,r.src=e,n.parentNode.insertBefore(r,n),i=setInterval(function(){a.io&&(clearInterval(i),y())},10)}function y(){var e=r.get("gsclick");s=io.connect(),s.on("ready",function(){l&&e!==a.location.href&&s.emit("href",a.location.href.replace(/(gsdriver=[^&]*)/ig,"")),b()}),s.emit("join",u),s.on("href",function(e){a.location=e}),s.on("event",h)}function b(){f.addEventListener("click",v,!1);var e=f.querySelector("input");e&&(e.addEventListener("change",m,!1),e.addEventListener("focus",c,!1),e.addEventListener("blur",c,!1))}var i="/socket.io/socket.io.js",s,o,u,a,f,l=!1;return r.expiresMultiplier=1,{init:function(t,n,s){var c;a=n,f=s,o=e.parse(a.location),u=o.queryKey.gskey||e.parse(t).queryKey.gskey,c=e.parse(t),c.path=i,u&&(o.queryKey.gsdriver||r.get("gsdriver")===u?(r.set("gsdriver",u,{expires:31536e3}),l=!0):r.remove("gsdriver"),g(e.make(c)))}}}),function(e,t){var n=t.getElementsByTagName("script"),r=n[n.length-1],i=r.src,s=require("client").init(r.src,e,t)}(window,document);